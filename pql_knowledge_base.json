{
  "metadata": {
    "version": "2.1",
    "total_examples": 22,
    "rfm_compatible_count": 12,
    "enterprise_only_count": 10,
    "cleanup_applied": [
      "[samples_001] removed: duplicate of rfm_qs_004",
      "[samples_005] removed: unverified, references non-existent returns table",
      "[samples_006] removed: EVALUATE wrapper, redundant with rfm_qs_002",
      "[samples_007] removed: EVALUATE wrapper, redundant with rfm_qs_003",
      "[samples_008] removed: EVALUATE + unverified returns table",
      "[ent_linkpred_001] removed: static link prediction unsupported in RFM",
      "[sdk_intro_001] removed: ASSUMING clause enterprise-only, niche",
      "[rfm_qs_003] fixed: target_column_type categorical -> id (FK column)",
      "[pql_tut_002] fixed: target_column_type categorical -> id (FK column)",
      "[snow_rec_001] fixed: target_column_type categorical -> id (FK column)"
    ],
    "aggregation_type_rules": {
      "SUM": {
        "valid_types": ["numeric", "float", "int", "numerical"],
        "invalid_types": ["id", "categorical", "text", "time"]
      },
      "AVG": {
        "valid_types": ["numeric", "float", "int", "numerical"],
        "invalid_types": ["id", "categorical", "text", "time"]
      },
      "MAX": {
        "valid_types": ["numeric", "float", "int", "numerical"],
        "invalid_types": ["id", "categorical", "text", "time"]
      },
      "MIN": {
        "valid_types": ["numeric", "float", "int", "numerical"],
        "invalid_types": ["id", "categorical", "text", "time"]
      },
      "COUNT": {
        "valid_types": ["any (use * wildcard)"],
        "invalid_types": []
      },
      "COUNT_DISTINCT": {
        "valid_types": ["categorical", "text"],
        "invalid_types": ["id (PK/FK)"]
      },
      "LIST_DISTINCT": {
        "valid_types": ["id (FK)", "categorical"],
        "invalid_types": ["numeric"]
      },
      "FIRST": {
        "valid_types": ["categorical"],
        "invalid_types": ["id", "numeric"]
      }
    },
    "known_limitations": [
      "EVALUATE PREDICT is enterprise-only (requires stored model). Free KumoRFM trains on-the-fly.",
      "FOR EACH is enterprise-only. Use FOR entity.col = value or FOR entity.col IN (v1, v2, ...)",
      "COUNT_DISTINCT cannot operate on PK/FK (ID-type) columns",
      "SUM/AVG/MAX/MIN only work on numeric columns",
      "LIST_DISTINCT only works on FK/categorical columns, must include RANK TOP k",
      "FIRST aggregation: unconfirmed for free tier",
      "ASSUMING clause: enterprise-only",
      "Target table must have DIRECT FK link to entity table (no multi-hop)"
    ]
  },
  "examples": [
    {
      "id": "rfm_qs_001",
      "pql": "PREDICT SUM(orders.price, 0, 30, days) FOR items.item_id=1",
      "natural_language": "Forecast 30-day product demand (revenue) for item 1",
      "task_type": "regression",
      "intent": "demand_forecast",
      "aggregation": "SUM",
      "target_table": "orders",
      "target_column": "price",
      "target_column_type": "numeric",
      "entity_table": "items",
      "entity_column": "item_id",
      "time_window_start": 0,
      "time_window_end": 30,
      "time_unit": "days",
      "uses_where": false,
      "where_clause": null,
      "uses_rank_top_k": false,
      "uses_evaluate": false,
      "for_style": "single_id",
      "rfm_compatible": true,
      "dataset": "online-shopping",
      "dataset_url": "s3://kumo-sdk-public/rfm-datasets/online-shopping",
      "dataset_tables": {
        "users": {
          "columns": ["user_id", "age", "gender"],
          "primary_key": "user_id",
          "has_timestamp": false
        },
        "items": {
          "columns": ["item_id", "category", "price"],
          "primary_key": "item_id",
          "has_timestamp": false
        },
        "orders": {
          "columns": ["order_id", "user_id", "item_id", "price", "timestamp"],
          "primary_key": "order_id",
          "has_timestamp": true,
          "time_column": "timestamp"
        }
      },
      "source": "KumoRFM Quick Start",
      "source_url": "https://kumo.ai/docs/rfm/RFM-quickstart/",
      "verified": true
    },
    {
      "id": "rfm_qs_002",
      "pql": "PREDICT COUNT(orders.*, 0, 90, days)=0 FOR users.user_id IN (42, 123)",
      "natural_language": "Predict whether users 42 and 123 will have zero orders in the next 90 days (churn prediction)",
      "task_type": "binary_classification",
      "intent": "churn",
      "aggregation": "COUNT",
      "target_table": "orders",
      "target_column": "*",
      "target_column_type": "any",
      "entity_table": "users",
      "entity_column": "user_id",
      "time_window_start": 0,
      "time_window_end": 90,
      "time_unit": "days",
      "uses_where": false,
      "where_clause": null,
      "uses_rank_top_k": false,
      "uses_evaluate": false,
      "for_style": "in_list",
      "rfm_compatible": true,
      "dataset": "online-shopping",
      "dataset_url": "s3://kumo-sdk-public/rfm-datasets/online-shopping",
      "dataset_tables": {
        "users": {
          "columns": ["user_id", "age", "gender"],
          "primary_key": "user_id",
          "has_timestamp": false
        },
        "items": {
          "columns": ["item_id", "category", "price"],
          "primary_key": "item_id",
          "has_timestamp": false
        },
        "orders": {
          "columns": ["order_id", "user_id", "item_id", "price", "timestamp"],
          "primary_key": "order_id",
          "has_timestamp": true,
          "time_column": "timestamp"
        }
      },
      "source": "KumoRFM Quick Start",
      "source_url": "https://kumo.ai/docs/rfm/RFM-quickstart/",
      "verified": true
    },
    {
      "id": "rfm_qs_003",
      "pql": "PREDICT LIST_DISTINCT(orders.item_id, 0, 30, days) RANK TOP 10 FOR users.user_id=123",
      "natural_language": "Recommend top 10 items user 123 is likely to order in the next 30 days",
      "task_type": "link_prediction",
      "intent": "product_recommendation",
      "aggregation": "LIST_DISTINCT",
      "target_table": "orders",
      "target_column": "item_id",
      "target_column_type": "id",
      "entity_table": "users",
      "entity_column": "user_id",
      "time_window_start": 0,
      "time_window_end": 30,
      "time_unit": "days",
      "uses_where": false,
      "where_clause": null,
      "uses_rank_top_k": true,
      "rank_top_k": 10,
      "uses_evaluate": false,
      "for_style": "single_id",
      "rfm_compatible": true,
      "dataset": "online-shopping",
      "dataset_url": "s3://kumo-sdk-public/rfm-datasets/online-shopping",
      "dataset_tables": {
        "users": {
          "columns": ["user_id", "age", "gender"],
          "primary_key": "user_id",
          "has_timestamp": false
        },
        "items": {
          "columns": ["item_id", "category", "price"],
          "primary_key": "item_id",
          "has_timestamp": false
        },
        "orders": {
          "columns": ["order_id", "user_id", "item_id", "price", "timestamp"],
          "primary_key": "order_id",
          "has_timestamp": true,
          "time_column": "timestamp"
        }
      },
      "source": "KumoRFM Quick Start",
      "source_url": "https://kumo.ai/docs/rfm/RFM-quickstart/",
      "verified": true
    },
    {
      "id": "rfm_qs_004",
      "pql": "PREDICT users.age FOR users.user_id=8",
      "natural_language": "Impute (predict) the missing age attribute for user 8",
      "task_type": "regression",
      "intent": "missing_value_imputation",
      "aggregation": null,
      "target_table": "users",
      "target_column": "age",
      "target_column_type": "numeric",
      "entity_table": "users",
      "entity_column": "user_id",
      "time_window_start": null,
      "time_window_end": null,
      "time_unit": null,
      "uses_where": false,
      "where_clause": null,
      "uses_rank_top_k": false,
      "uses_evaluate": false,
      "for_style": "single_id",
      "rfm_compatible": true,
      "dataset": "online-shopping",
      "dataset_url": "s3://kumo-sdk-public/rfm-datasets/online-shopping",
      "dataset_tables": {
        "users": {
          "columns": ["user_id", "age", "gender"],
          "primary_key": "user_id",
          "has_timestamp": false
        },
        "items": {
          "columns": ["item_id", "category", "price"],
          "primary_key": "item_id",
          "has_timestamp": false
        },
        "orders": {
          "columns": ["order_id", "user_id", "item_id", "price", "timestamp"],
          "primary_key": "order_id",
          "has_timestamp": true,
          "time_column": "timestamp"
        }
      },
      "source": "KumoRFM Quick Start",
      "source_url": "https://kumo.ai/docs/rfm/RFM-quickstart/",
      "verified": true
    },
    {
      "id": "rfm_mp_001",
      "pql": "PREDICT SUM(orders.PRICE, 0, 30) FOR customers.customer_id=101",
      "natural_language": "Predict total spending for customer 101 over the next 30 days",
      "task_type": "regression",
      "intent": "ltv",
      "aggregation": "SUM",
      "target_table": "orders",
      "target_column": "PRICE",
      "target_column_type": "numeric",
      "entity_table": "customers",
      "entity_column": "customer_id",
      "time_window_start": 0,
      "time_window_end": 30,
      "time_unit": "days",
      "uses_where": false,
      "where_clause": null,
      "uses_rank_top_k": false,
      "uses_evaluate": false,
      "for_style": "single_id",
      "rfm_compatible": true,
      "dataset": "generic_customers_orders",
      "dataset_url": null,
      "dataset_tables": {
        "customers": {
          "columns": ["customer_id"],
          "primary_key": "customer_id"
        },
        "orders": {
          "columns": ["PRICE"],
          "has_timestamp": true
        }
      },
      "source": "KumoRFM Make Predictions page",
      "source_url": "https://kumo.ai/docs/rfm/RFM-make-predictions/",
      "verified": true
    },
    {
      "id": "pql_tut_001",
      "pql": "PREDICT AVG(reviews.is_recommended, 0, 12, months) FOR games.app_id=440 WHERE COUNT(reviews.*, -12, 0, months) > 0",
      "natural_language": "Predict average recommendation rate for game 440 over the next 12 months, only considering games with recent review activity",
      "task_type": "regression",
      "intent": "engagement_forecast",
      "aggregation": "AVG",
      "target_table": "reviews",
      "target_column": "is_recommended",
      "target_column_type": "numeric",
      "entity_table": "games",
      "entity_column": "app_id",
      "time_window_start": 0,
      "time_window_end": 12,
      "time_unit": "months",
      "uses_where": true,
      "where_clause": "COUNT(reviews.*, -12, 0, months) > 0",
      "uses_rank_top_k": false,
      "uses_evaluate": false,
      "for_style": "single_id",
      "rfm_compatible": true,
      "dataset": "steam-games",
      "dataset_url": "s3://kumo-sdk-public/rfm-datasets/steam",
      "dataset_tables": {
        "games": {
          "columns": ["app_id", "title"],
          "primary_key": "app_id",
          "has_timestamp": false
        },
        "users": {
          "columns": ["user_id"],
          "primary_key": "user_id",
          "has_timestamp": false
        },
        "reviews": {
          "columns": ["review_id", "app_id", "user_id", "is_recommended", "timestamp"],
          "primary_key": "review_id",
          "has_timestamp": true,
          "time_column": "timestamp"
        }
      },
      "source": "KumoRFM PQL Tutorial Notebook (pql_tutorial.ipynb)",
      "source_url": "https://github.com/kumo-ai/kumo-rfm/blob/master/notebooks/pql_tutorial.ipynb",
      "verified": true
    },
    {
      "id": "pql_tut_002",
      "pql": "PREDICT LIST_DISTINCT(reviews.app_id, 0, 12, months) RANK TOP 3 FOR users.user_id=11764552",
      "natural_language": "Recommend top 3 games user 11764552 will review in the next 12 months",
      "task_type": "link_prediction",
      "intent": "game_recommendation",
      "aggregation": "LIST_DISTINCT",
      "target_table": "reviews",
      "target_column": "app_id",
      "target_column_type": "id",
      "entity_table": "users",
      "entity_column": "user_id",
      "time_window_start": 0,
      "time_window_end": 12,
      "time_unit": "months",
      "uses_where": false,
      "where_clause": null,
      "uses_rank_top_k": true,
      "rank_top_k": 3,
      "uses_evaluate": false,
      "for_style": "single_id",
      "rfm_compatible": true,
      "dataset": "steam-games",
      "dataset_url": "s3://kumo-sdk-public/rfm-datasets/steam",
      "dataset_tables": {
        "games": {
          "columns": ["app_id", "title"],
          "primary_key": "app_id",
          "has_timestamp": false
        },
        "users": {
          "columns": ["user_id"],
          "primary_key": "user_id",
          "has_timestamp": false
        },
        "reviews": {
          "columns": ["review_id", "app_id", "user_id", "is_recommended", "timestamp"],
          "primary_key": "review_id",
          "has_timestamp": true,
          "time_column": "timestamp"
        }
      },
      "source": "KumoRFM PQL Tutorial Notebook (pql_tutorial.ipynb)",
      "source_url": "https://github.com/kumo-ai/kumo-rfm/blob/master/notebooks/pql_tutorial.ipynb",
      "verified": true
    },
    {
      "id": "samples_002",
      "pql": "PREDICT SUM(orders.price, 0, 30, days) FOR users.user_id=456",
      "natural_language": "Predict 30-day spending for user 456",
      "task_type": "regression",
      "intent": "ltv",
      "aggregation": "SUM",
      "target_table": "orders",
      "target_column": "price",
      "target_column_type": "numeric",
      "entity_table": "users",
      "entity_column": "user_id",
      "time_window_start": 0,
      "time_window_end": 30,
      "time_unit": "days",
      "uses_where": false,
      "where_clause": null,
      "uses_rank_top_k": false,
      "uses_evaluate": false,
      "for_style": "single_id",
      "rfm_compatible": true,
      "dataset": "online-shopping",
      "dataset_url": "s3://kumo-sdk-public/rfm-datasets/online-shopping",
      "dataset_tables": {
        "users": {
          "columns": ["user_id", "age", "gender"],
          "primary_key": "user_id"
        },
        "items": {
          "columns": ["item_id", "category", "price"],
          "primary_key": "item_id"
        },
        "orders": {
          "columns": ["order_id", "user_id", "item_id", "price", "timestamp"],
          "primary_key": "order_id",
          "has_timestamp": true
        }
      },
      "source": "User-provided samples.json (consistent with RFM quickstart schema)",
      "source_url": "https://kumo.ai/docs/rfm/RFM-quickstart/",
      "verified": true
    },
    {
      "id": "samples_003",
      "pql": "PREDICT COUNT(orders.*, 0, 90, days) = 0 FOR users.user_id=789",
      "natural_language": "Predict if user 789 will churn (zero orders) in the next 90 days",
      "task_type": "binary_classification",
      "intent": "churn",
      "aggregation": "COUNT",
      "target_table": "orders",
      "target_column": "*",
      "target_column_type": "any",
      "entity_table": "users",
      "entity_column": "user_id",
      "time_window_start": 0,
      "time_window_end": 90,
      "time_unit": "days",
      "uses_where": false,
      "where_clause": null,
      "uses_rank_top_k": false,
      "uses_evaluate": false,
      "for_style": "single_id",
      "rfm_compatible": true,
      "dataset": "online-shopping",
      "dataset_url": "s3://kumo-sdk-public/rfm-datasets/online-shopping",
      "dataset_tables": {
        "users": {
          "columns": ["user_id", "age", "gender"],
          "primary_key": "user_id"
        },
        "items": {
          "columns": ["item_id", "category", "price"],
          "primary_key": "item_id"
        },
        "orders": {
          "columns": ["order_id", "user_id", "item_id", "price", "timestamp"],
          "primary_key": "order_id",
          "has_timestamp": true
        }
      },
      "source": "User-provided samples.json (consistent with RFM quickstart schema)",
      "source_url": "https://kumo.ai/docs/rfm/RFM-quickstart/",
      "verified": true
    },
    {
      "id": "samples_009",
      "pql": "PREDICT SUM(orders.price, 0, 90, days) FOR items.item_id IN (111, 112, 113)",
      "natural_language": "Predict the sales revenue from items 111, 112, and 113 in the next 90 days",
      "task_type": "regression",
      "intent": "revenue_forecast",
      "aggregation": "SUM",
      "target_table": "orders",
      "target_column": "price",
      "target_column_type": "numeric",
      "entity_table": "items",
      "entity_column": "item_id",
      "time_window_start": 0,
      "time_window_end": 90,
      "time_unit": "days",
      "uses_where": false,
      "where_clause": null,
      "uses_rank_top_k": false,
      "uses_evaluate": false,
      "for_style": "in_list",
      "rfm_compatible": true,
      "dataset": "online-shopping",
      "dataset_url": "s3://kumo-sdk-public/rfm-datasets/online-shopping",
      "dataset_tables": {
        "users": {
          "columns": ["user_id", "age", "gender"],
          "primary_key": "user_id"
        },
        "items": {
          "columns": ["item_id", "category", "price"],
          "primary_key": "item_id"
        },
        "orders": {
          "columns": ["order_id", "user_id", "item_id", "price", "timestamp"],
          "primary_key": "order_id",
          "has_timestamp": true
        }
      },
      "source": "User-provided samples.json",
      "source_url": null,
      "verified": true
    },
    {
      "id": "samples_010",
      "pql": "PREDICT COUNT(orders.*, 0, 7, days) > 0 FOR users.user_id=123",
      "natural_language": "Predict whether user 123 will make an order in the next 7 days",
      "task_type": "binary_classification",
      "intent": "activity_prediction",
      "aggregation": "COUNT",
      "target_table": "orders",
      "target_column": "*",
      "target_column_type": "any",
      "entity_table": "users",
      "entity_column": "user_id",
      "time_window_start": 0,
      "time_window_end": 7,
      "time_unit": "days",
      "uses_where": false,
      "where_clause": null,
      "uses_rank_top_k": false,
      "uses_evaluate": false,
      "for_style": "single_id",
      "rfm_compatible": true,
      "dataset": "online-shopping",
      "dataset_url": "s3://kumo-sdk-public/rfm-datasets/online-shopping",
      "dataset_tables": {
        "users": {
          "columns": ["user_id", "age", "gender"],
          "primary_key": "user_id"
        },
        "items": {
          "columns": ["item_id", "category", "price"],
          "primary_key": "item_id"
        },
        "orders": {
          "columns": ["order_id", "user_id", "item_id", "price", "timestamp"],
          "primary_key": "order_id",
          "has_timestamp": true
        }
      },
      "source": "User-provided samples.json",
      "source_url": null,
      "verified": true
    },
    {
      "id": "samples_011",
      "pql": "PREDICT MAX(orders.price, 0, 30, days) FOR users.user_id=7",
      "natural_language": "Predict the maximum single order spending for user 7 in the next 30 days",
      "task_type": "regression",
      "intent": "spending_forecast",
      "aggregation": "MAX",
      "target_table": "orders",
      "target_column": "price",
      "target_column_type": "numeric",
      "entity_table": "users",
      "entity_column": "user_id",
      "time_window_start": 0,
      "time_window_end": 30,
      "time_unit": "days",
      "uses_where": false,
      "where_clause": null,
      "uses_rank_top_k": false,
      "uses_evaluate": false,
      "for_style": "single_id",
      "rfm_compatible": true,
      "dataset": "online-shopping",
      "dataset_url": "s3://kumo-sdk-public/rfm-datasets/online-shopping",
      "dataset_tables": {
        "users": {
          "columns": ["user_id", "age", "gender"],
          "primary_key": "user_id"
        },
        "items": {
          "columns": ["item_id", "category", "price"],
          "primary_key": "item_id"
        },
        "orders": {
          "columns": ["order_id", "user_id", "item_id", "price", "timestamp"],
          "primary_key": "order_id",
          "has_timestamp": true
        }
      },
      "source": "User-provided samples.json",
      "source_url": null,
      "verified": true
    },
    {
      "id": "ent_age_001",
      "pql": "PREDICT customers.age FOR EACH customers.customer_id",
      "natural_language": "Predict the age of all customers where age is missing",
      "task_type": "regression",
      "intent": "missing_value_imputation",
      "aggregation": null,
      "target_table": "customers",
      "target_column": "age",
      "target_column_type": "numeric",
      "entity_table": "customers",
      "entity_column": "customer_id",
      "time_window_start": null,
      "time_window_end": null,
      "time_unit": null,
      "uses_where": false,
      "where_clause": null,
      "uses_rank_top_k": false,
      "uses_evaluate": false,
      "for_style": "for_each",
      "rfm_compatible": false,
      "rfm_equivalent": "PREDICT customers.age FOR customers.customer_id IN (id1, id2, ...)",
      "dataset": "h_and_m",
      "dataset_url": null,
      "dataset_tables": {
        "customers": {
          "columns": ["customer_id", "age"],
          "primary_key": "customer_id"
        },
        "transactions": {
          "columns": ["customer_id", "article_id", "price", "t_dat"],
          "has_timestamp": true,
          "time_column": "t_dat"
        },
        "articles": {
          "columns": ["article_id", "product_type_name", "colour_group_name"],
          "primary_key": "article_id"
        }
      },
      "source": "Kumo Enterprise Docs - Translating Business Problems",
      "source_url": "https://docs.kumo.ai/docs/predictive-task-reference",
      "verified": true
    },
    {
      "id": "ent_movie_001",
      "pql": "PREDICT rating.rating FOR EACH rating.ratingId",
      "natural_language": "Predict movie ratings for all user-movie pairs",
      "task_type": "regression",
      "intent": "rating_prediction",
      "aggregation": null,
      "target_table": "rating",
      "target_column": "rating",
      "target_column_type": "numeric",
      "entity_table": "rating",
      "entity_column": "ratingId",
      "time_window_start": null,
      "time_window_end": null,
      "time_unit": null,
      "uses_where": false,
      "where_clause": null,
      "uses_rank_top_k": false,
      "uses_evaluate": false,
      "for_style": "for_each",
      "rfm_compatible": false,
      "rfm_equivalent": "PREDICT rating.rating FOR rating.ratingId IN (id1, id2, ...)",
      "dataset": "movie_ratings",
      "dataset_url": null,
      "dataset_tables": {
        "user": {
          "columns": ["userId", "age", "gender"],
          "primary_key": "userId"
        },
        "movie": {
          "columns": ["movieId", "genre", "director", "release_year"],
          "primary_key": "movieId"
        },
        "rating": {
          "columns": ["ratingId", "userId", "movieId", "rating"],
          "primary_key": "ratingId"
        }
      },
      "source": "Kumo Enterprise Docs - Translating Business Problems",
      "source_url": "https://docs.kumo.ai/docs/predictive-task-reference",
      "verified": true
    },
    {
      "id": "ent_ltv_001",
      "pql": "PREDICT SUM(transactions.price, 0, 30) FOR EACH customers.customer_id",
      "natural_language": "Predict how much each customer will spend over the next 30 days (LTV)",
      "task_type": "regression",
      "intent": "ltv",
      "aggregation": "SUM",
      "target_table": "transactions",
      "target_column": "price",
      "target_column_type": "numeric",
      "entity_table": "customers",
      "entity_column": "customer_id",
      "time_window_start": 0,
      "time_window_end": 30,
      "time_unit": "days",
      "uses_where": false,
      "where_clause": null,
      "uses_rank_top_k": false,
      "uses_evaluate": false,
      "for_style": "for_each",
      "rfm_compatible": false,
      "rfm_equivalent": "PREDICT SUM(transactions.price, 0, 30) FOR customers.customer_id IN (id1, id2, ...)",
      "dataset": "h_and_m",
      "dataset_url": null,
      "dataset_tables": {
        "customers": {
          "columns": ["customer_id", "age"],
          "primary_key": "customer_id"
        },
        "transactions": {
          "columns": ["customer_id", "article_id", "price", "t_dat"],
          "has_timestamp": true
        },
        "articles": {
          "columns": ["article_id", "product_type_name"],
          "primary_key": "article_id"
        }
      },
      "source": "Kumo Enterprise Docs - Translating Business Problems",
      "source_url": "https://docs.kumo.ai/docs/predictive-task-reference",
      "verified": true
    },
    {
      "id": "ent_ltv_active_001",
      "pql": "PREDICT SUM(transactions.price, 0, 30) FOR EACH customers.customer_id WHERE COUNT(transactions.*, -30, 0) > 0",
      "natural_language": "Predict 30-day spend for active customers only (those who purchased in last 30 days)",
      "task_type": "regression",
      "intent": "ltv_active_customers",
      "aggregation": "SUM",
      "target_table": "transactions",
      "target_column": "price",
      "target_column_type": "numeric",
      "entity_table": "customers",
      "entity_column": "customer_id",
      "time_window_start": 0,
      "time_window_end": 30,
      "time_unit": "days",
      "uses_where": true,
      "where_clause": "COUNT(transactions.*, -30, 0) > 0",
      "uses_rank_top_k": false,
      "uses_evaluate": false,
      "for_style": "for_each",
      "rfm_compatible": false,
      "rfm_equivalent": "PREDICT SUM(transactions.price, 0, 30) FOR customers.customer_id IN (ids) WHERE COUNT(transactions.*, -30, 0) > 0",
      "dataset": "h_and_m",
      "dataset_url": null,
      "dataset_tables": {
        "customers": {
          "columns": ["customer_id", "age"],
          "primary_key": "customer_id"
        },
        "transactions": {
          "columns": ["customer_id", "article_id", "price", "t_dat"],
          "has_timestamp": true
        },
        "articles": {
          "columns": ["article_id", "product_type_name"],
          "primary_key": "article_id"
        }
      },
      "source": "Kumo Enterprise Docs - Translating Business Problems",
      "source_url": "https://docs.kumo.ai/docs/predictive-task-reference",
      "verified": true
    },
    {
      "id": "ent_churn_001",
      "pql": "PREDICT COUNT(transactions.*, 0, 90, days) = 0 FOR EACH customers.customer_id WHERE COUNT(transactions.*, -60, 0, days) > 0",
      "natural_language": "Predict whether active customers (purchased in last 60 days) will churn in the next 90 days",
      "task_type": "binary_classification",
      "intent": "churn_active_customers",
      "aggregation": "COUNT",
      "target_table": "transactions",
      "target_column": "*",
      "target_column_type": "any",
      "entity_table": "customers",
      "entity_column": "customer_id",
      "time_window_start": 0,
      "time_window_end": 90,
      "time_unit": "days",
      "uses_where": true,
      "where_clause": "COUNT(transactions.*, -60, 0, days) > 0",
      "uses_rank_top_k": false,
      "uses_evaluate": false,
      "for_style": "for_each",
      "rfm_compatible": false,
      "rfm_equivalent": "PREDICT COUNT(transactions.*, 0, 90, days) = 0 FOR customers.customer_id IN (ids) WHERE COUNT(transactions.*, -60, 0, days) > 0",
      "dataset": "h_and_m",
      "dataset_url": null,
      "dataset_tables": {
        "customers": {
          "columns": ["customer_id", "age"],
          "primary_key": "customer_id"
        },
        "transactions": {
          "columns": ["customer_id", "article_id", "price", "t_dat"],
          "has_timestamp": true
        },
        "articles": {
          "columns": ["article_id", "product_type_name"],
          "primary_key": "article_id"
        }
      },
      "source": "Kumo Enterprise Docs - Translating Business Problems",
      "source_url": "https://docs.kumo.ai/docs/predictive-task-reference",
      "verified": true
    },
    {
      "id": "ent_fraud_001",
      "pql": "PREDICT fraud_reports.is_fraud FOR EACH transaction.id WHERE transaction.type = \"bank transfer\"",
      "natural_language": "Detect fraudulent bank transfer transactions",
      "task_type": "binary_classification",
      "intent": "fraud_detection",
      "aggregation": null,
      "target_table": "fraud_reports",
      "target_column": "is_fraud",
      "target_column_type": "boolean",
      "entity_table": "transaction",
      "entity_column": "id",
      "time_window_start": null,
      "time_window_end": null,
      "time_unit": null,
      "uses_where": true,
      "where_clause": "transaction.type = \"bank transfer\"",
      "uses_rank_top_k": false,
      "uses_evaluate": false,
      "for_style": "for_each",
      "rfm_compatible": false,
      "rfm_equivalent": "PREDICT fraud_reports.is_fraud FOR transaction.id = <value>",
      "dataset": "banking_fraud",
      "dataset_url": null,
      "dataset_tables": {
        "users": {
          "columns": ["user_id", "age", "gender"],
          "primary_key": "user_id"
        },
        "transaction": {
          "columns": ["id", "fraud_report_id", "type", "date", "amount", "sender_id", "receiver_id"],
          "primary_key": "id",
          "has_timestamp": true,
          "time_column": "date"
        },
        "fraud_reports": {
          "columns": ["fraud_report_id", "report_timestamp", "is_fraud"],
          "primary_key": "fraud_report_id",
          "has_timestamp": true
        }
      },
      "source": "Kumo Enterprise Docs - Translating Business Problems",
      "source_url": "https://docs.kumo.ai/docs/predictive-task-reference",
      "verified": true
    },
    {
      "id": "ent_nextitem_001",
      "pql": "PREDICT FIRST(purchase.type, 0, 7) FOR EACH user.user_id",
      "natural_language": "Predict the type of the next purchase each user will make in 7 days",
      "task_type": "multiclass_classification",
      "intent": "next_item_category",
      "aggregation": "FIRST",
      "target_table": "purchase",
      "target_column": "type",
      "target_column_type": "categorical",
      "entity_table": "user",
      "entity_column": "user_id",
      "time_window_start": 0,
      "time_window_end": 7,
      "time_unit": "days",
      "uses_where": false,
      "where_clause": null,
      "uses_rank_top_k": false,
      "uses_evaluate": false,
      "for_style": "for_each",
      "rfm_compatible": false,
      "rfm_equivalent": "FIRST aggregation unconfirmed for free tier. Alternative: PREDICT LIST_DISTINCT(purchase.type, 0, 7) RANK TOP 1 FOR user.user_id = <value>",
      "dataset": "clothing_retailer",
      "dataset_url": null,
      "dataset_tables": {
        "user": {
          "columns": ["user_id", "age", "gender"],
          "primary_key": "user_id"
        },
        "purchase": {
          "columns": ["user_id", "item_id", "purchase_date", "purchase_value", "type"],
          "has_timestamp": true,
          "time_column": "purchase_date"
        },
        "items": {
          "columns": ["item_id", "description", "size"],
          "primary_key": "item_id"
        }
      },
      "source": "Kumo Enterprise Docs - Translating Business Problems",
      "source_url": "https://docs.kumo.ai/docs/predictive-task-reference",
      "verified": true
    },
    {
      "id": "ent_likes_001",
      "pql": "PREDICT customer_item_pairs.likes = 1 FOR EACH customer_item_pairs.uuid",
      "natural_language": "Predict the probability that a user will like a particular item",
      "task_type": "binary_classification",
      "intent": "like_prediction",
      "aggregation": null,
      "target_table": "customer_item_pairs",
      "target_column": "likes",
      "target_column_type": "boolean",
      "entity_table": "customer_item_pairs",
      "entity_column": "uuid",
      "time_window_start": null,
      "time_window_end": null,
      "time_unit": null,
      "uses_where": false,
      "where_clause": null,
      "uses_rank_top_k": false,
      "uses_evaluate": false,
      "for_style": "for_each",
      "rfm_compatible": false,
      "rfm_equivalent": "PREDICT customer_item_pairs.likes = 1 FOR customer_item_pairs.uuid = <value>",
      "dataset": "ecommerce_with_likes",
      "dataset_url": null,
      "dataset_tables": {
        "customers": {
          "columns": ["customer_id"],
          "primary_key": "customer_id"
        },
        "items": {
          "columns": ["item_id"],
          "primary_key": "item_id"
        },
        "customer_item_pairs": {
          "columns": ["uuid", "customer_id", "item_id", "likes"],
          "primary_key": "uuid"
        }
      },
      "source": "Kumo Enterprise Docs - Translating Business Problems",
      "source_url": "https://docs.kumo.ai/docs/predictive-task-reference",
      "verified": true
    },
    {
      "id": "snow_ltv_001",
      "pql": "PREDICT SUM(WEB_SALES_MINI.WS_EXT_SALES_PRICE, 0, 30) FOR EACH CUSTOMERS_MINI.C_CUSTOMER_SK",
      "natural_language": "Predict how much each customer will spend over the next 30 days (Snowflake TPC-DS dataset)",
      "task_type": "regression",
      "intent": "ltv",
      "aggregation": "SUM",
      "target_table": "WEB_SALES_MINI",
      "target_column": "WS_EXT_SALES_PRICE",
      "target_column_type": "numeric",
      "entity_table": "CUSTOMERS_MINI",
      "entity_column": "C_CUSTOMER_SK",
      "time_window_start": 0,
      "time_window_end": 30,
      "time_unit": "days",
      "uses_where": false,
      "where_clause": null,
      "uses_rank_top_k": false,
      "uses_evaluate": false,
      "for_style": "for_each",
      "rfm_compatible": false,
      "rfm_equivalent": "PREDICT SUM(WEB_SALES_MINI.WS_EXT_SALES_PRICE, 0, 30) FOR CUSTOMERS_MINI.C_CUSTOMER_SK = <value>",
      "dataset": "snowflake_tpcds",
      "dataset_url": null,
      "dataset_tables": {
        "CUSTOMERS_MINI": {
          "columns": ["C_CUSTOMER_SK"],
          "primary_key": "C_CUSTOMER_SK"
        },
        "WEB_SALES_MINI": {
          "columns": ["WS_ITEM_SK", "WS_EXT_SALES_PRICE"],
          "has_timestamp": true
        }
      },
      "source": "Snowflake Quickstart - Product Recommendations for High LTV Customers using Kumo",
      "source_url": "https://quickstarts.snowflake.com/guide/leveraging_kumo_for_smarter_recommendations/index.html",
      "verified": true,
      "rfm_equivalent": "PREDICT SUM(WEB_SALES_MINI.WS_EXT_SALES_PRICE, 0, 30) FOR CUSTOMERS_MINI.C_CUSTOMER_SK = <value>"
    },
    {
      "id": "snow_rec_001",
      "pql": "PREDICT LIST_DISTINCT(WEB_SALES_MINI.WS_ITEM_SK, 0, 30) RANK TOP 10 FOR EACH CUSTOMERS_MINI.C_CUSTOMER_SK",
      "natural_language": "Recommend top 10 products customers are most likely to purchase in the next 30 days (Snowflake)",
      "task_type": "link_prediction",
      "intent": "product_recommendation",
      "aggregation": "LIST_DISTINCT",
      "target_table": "WEB_SALES_MINI",
      "target_column": "WS_ITEM_SK",
      "target_column_type": "id",
      "entity_table": "CUSTOMERS_MINI",
      "entity_column": "C_CUSTOMER_SK",
      "time_window_start": 0,
      "time_window_end": 30,
      "time_unit": "days",
      "uses_where": false,
      "where_clause": null,
      "uses_rank_top_k": true,
      "rank_top_k": 10,
      "uses_evaluate": false,
      "for_style": "for_each",
      "rfm_compatible": false,
      "rfm_equivalent": "PREDICT LIST_DISTINCT(WEB_SALES_MINI.WS_ITEM_SK, 0, 30) RANK TOP 10 FOR CUSTOMERS_MINI.C_CUSTOMER_SK = <value>",
      "dataset": "snowflake_tpcds",
      "dataset_url": null,
      "dataset_tables": {
        "CUSTOMERS_MINI": {
          "columns": ["C_CUSTOMER_SK"],
          "primary_key": "C_CUSTOMER_SK"
        },
        "WEB_SALES_MINI": {
          "columns": ["WS_ITEM_SK", "WS_EXT_SALES_PRICE"],
          "has_timestamp": true
        }
      },
      "source": "Snowflake Quickstart - Product Recommendations for High LTV Customers using Kumo",
      "source_url": "https://quickstarts.snowflake.com/guide/leveraging_kumo_for_smarter_recommendations/index.html",
      "verified": true
    }
  ]
}
